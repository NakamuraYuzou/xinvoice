DROP VIEW 【XI】VBBtoCCTop;

CREATE VIEW 【XI】VBBtoCCTop AS
 SELECT
	 A.【全体情報】請求書管理コード				 AS 請求書管理コード,
	 A.【おもて情報】請求書番号					 AS 請求書番号,
	 A.【おもて情報】請求書発行日					 AS 請求書発行日,
	 A.【おもて情報】支払期限						 AS 支払期限,
	 A.【おもて情報】件名						 AS 件名,
	 A.【おもて情報】今回請求金額＃税込				 AS 請求金額,
	 A.【おもて情報】請求元						 AS 請求元,
	 A.【おもて情報】請求先						 AS 請求先,
	 A.【追加情報】ステータス						 AS ステータス,
	 B.取引先コード								 AS 取引先コード,
	 C.チェックパターン							 AS チェックパターン,
	 C.費用区分								 AS 費用区分,
	 C.費用区分名								 AS 費用区分名,
	 C.起票者メアド								 AS メアド,
	 C.起票者名								 AS 起票者名,
	 C.工事コード								 AS 工事コード,
	 C.工事詳細コード							 AS 工事詳細コード,
	 C.工事名									 AS 工事名,
	 C.部門コード								 AS 部門コード,
	 C.部門名									 AS 部門名
 FROM 【XI】BBCsv A
	 LEFT JOIN 【XI】BB請求元マスタ B ON A.【おもて情報】請求元 = B.請求元
	 LEFT JOIN 【XI】BB請求先件名マスタ C ON A.【追加情報】件名管理番号 = C.件名管理番号
 GROUP BY
	 A.【全体情報】請求書管理コード,
	 A.【おもて情報】請求書番号,
	 A.【おもて情報】請求書発行日,
	 A.【おもて情報】支払期限,
	 A.【おもて情報】件名,
	 A.【おもて情報】今回請求金額＃税込,
	 A.【おもて情報】請求元,
	 A.【おもて情報】請求先,
	 A.【追加情報】ステータス,
	 B.取引先コード,
	 C.チェックパターン,
	 C.費用区分,
	 C.費用区分名,
	 C.起票者メアド,
	 C.起票者名,
	 C.工事コード,
	 C.工事詳細コード,
	 C.工事名,
	 C.部門コード,
	 C.部門名
 ORDER BY A.【全体情報】請求書管理コード ASC
;
